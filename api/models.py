# Django
from django.db import models

# Third party
from uuid import uuid4

# Local

class Vulnerability(models.Model):

    created = models.DateTimeField(auto_now_add=True)

    id = models.UUIDField(
        primary_key=True,
        default= uuid4,
        editable=False
    )

    name = models.CharField(max_length= 120)

    severity = models.CharField(max_length= 20)
    cvss = models.FloatField()
    affected_hosts_amount = models.IntegerField()
    date_publication = models.CharField(max_length=20, null=True)


class Hosts(models.Model):

    created = models.DateTimeField(auto_now_add= True)

    id = models.UUIDField(
        primary_key = True,
        default = uuid4,
        editable= False
    )

    name = models.CharField(max_length=120)
    ip_address = models.CharField(max_length=20)
    risk = models.FloatField()
    vulnerabilities_amount = models.IntegerField()

class AffectedHosts(models.Model):

    created = models.DateTimeField(auto_now_add=True)

    id = models.UUIDField(
        primary_key=True,
        editable=False,
        default= uuid4
    )

    host = models.ForeignKey(Hosts, on_delete=models.CASCADE)
    vulnerability = models.ForeignKey(Vulnerability, on_delete=models.CASCADE)
    corrected = models.BooleanField()



# Create your models here.
