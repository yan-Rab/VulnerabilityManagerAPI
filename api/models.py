# Django
from django.db import models

# Third party

# Local

class Vulnerability(models.Model):

    created = models.DateTimeField(auto_now_add=True)
    name = models.CharField(max_length= 120)
    severity = models.CharField(max_length= 20)
    cvss = models.FloatField()
    affected_hosts_amount = models.IntegerField()
    date_publication = models.CharField(max_length=20, null=True)


class Host(models.Model):

    created = models.DateTimeField(auto_now_add= True)
    name = models.CharField(max_length=120)
    ip_address = models.CharField(max_length=20)
    risk = models.FloatField()
    vulnerabilities_amount = models.IntegerField()

class AffectedHost(models.Model):

    created = models.DateTimeField(auto_now_add=True, editable=False)
    host = models.ForeignKey(
        Host, 
        on_delete=models.CASCADE, 
        max_length= 100
    )
    vulnerability = models.ForeignKey(
        Vulnerability,
        on_delete =models.CASCADE,
        max_length= 100
    )
    corrected = models.BooleanField()



# Create your models here.
