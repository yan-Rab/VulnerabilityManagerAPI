# Django


# Third party
from rest_framework import serializers

# Local
from .models import AffectedHosts, Hosts,Vulnerability

class VulnerabilitySerializer(serializers.ModelSerializer):
    class Meta:
        model = Vulnerability
        fields = [
            'created',
            'id',
            'name',
            'severity',
            'cvss',
            'affected_hosts_amount',
            'date_publication'
        ]

class HostSerializer(serializers.ModelSerializer):

    class Meta:
        model = Hosts
        fields = [
            'created',
            'id',
            'name',
            'ip_address',
            'risk',
            'vulnerabilities_amount'
        ]


class AffectedHostsSerializerRelation(serializers.ModelSerializer):
    host = HostSerializer()
    vulnerability = VulnerabilitySerializer()

    class Meta:
        model = AffectedHosts
        fields = [
            'created',
            'id',
            'host',
            'vulnerability',
            'corrected'
        ]


class AffectedHostsSerializerEntity(serializers.ModelSerializer):

    class Meta:
        model = AffectedHosts
        fields = [
            'created',
            'id',
            'host',
            'vulnerability',
            'corrected'
        ]


class CardsHostSerializer(serializers.Serializer):
    total_hosts = serializers.IntegerField()
    vulnerable_hosts_amount = serializers.IntegerField()
